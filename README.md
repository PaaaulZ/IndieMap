# IndieMap
A Python script that finds cities in lyrics of Italian Indie Artists and a PHP page to show everything on a map

## DISCLAIMER

This is my first Python project and I'm a bit rusty in PHP so I wrote everything with the knowledge I have at this time. Don't expect something complicated, it's just a simple project for a simple concept.



## A BIT OF BACKGROUND

For those who don't know there is a meme in the Italian community about Indie artists using cities in every song, even the smallest unknown city (see Peschiera del Garda). I started this project to see if it's just a meme or the situation is really like that, you can judge by yourself watching the map.

## CONTENT

- cities.txt

It's a list of cities and countries of the world. I just manually removed some ambiguous names like "Amore, Onore, Pandino", they exist but unfortunately are also words in the italian dictionary so to avoid false matches I had to delete those.


---

- IndieMap_py.py

It's the download script, works in different steps:

1) Reads artists from a Spotify playlist of only Italian Indie songs and adds them to the artists.txt file, at the ends of this you'll have a list of Italian Indie artists to work with. Of course the file is open with append mode so it will not replace previously added artists and the code will skip already saved artists.
2) Reads songs titles from Genius for every single artist and stores them locally.
3) Reads lyrics for every song stored before and searches for cities/countries. Songs done are saved in the done.txt file so next time they will be skipped, matches found are stored in a json file (just info about the song and the city found, nothing more).
4) Reads the JSON file created before and adds info about the city (latitude and longitude).

At the end of this you will have:

- Artist.
- Title.
- City/Country name found in the lyrics.
- Genius link to read the full lyrics.
- A section of the lyrics to show where the match has been found.
- Latitude.
- Longitude.

**You will need a config.json, see config section below**

---

_website/map.php

It's the webpage to show the locations on the map, just that, nothing more.

**You will need to put the final json (json4map.json) near map.php**

## CONFIG TEMPLATE

```json
{
  "spotifyApiKey": "YOUR_SPOTIFY_API_KEY_HERE",
  "spotifyPlaylistID": "37i9dQZF1DX6PSDDh80gxI",
  "geniusApiKey": "YOUR_GENIUS_API_KEY_HERE"
}
```

You can of course change the **spotifyPlaylistID** with a Spotify playlist id of your choice.

## REQUIREMENTS

- Python 3.x

`https://www.python.org/downloads/`

---

- BeautifulSoup

`pip3 install BeautifulSoup4`

---

- Geopy

`pip3 install geopy`

## USAGE

1) Download or clone this repository.
2) Create a **config.json** with the template above and put it near **IndieMap_py.py**
3) Launch **IndieMap_py.py** and wait for it to finish.
4) Copy **_website/map.php** and **found4map.json** (generated by step 3) and paste into your webserver folder.
5) Visit **http://[your_server]/map.php**

## TODO

- Use a database instead of text files, this will work but I don't know for how long.
- Download song list in a database and not in a local array in **fetchSongs** function.
- Make a better **getCityLine** function. This sucks, gets "random" lines and it's a Frankenstein of copy/paste from Stackoverflow. For now it just works.
- Make the webpage better for mobile users.

## SIDE NOTES

If you have a Google Maps API you can change provider for GeoPy and search cities/countries with Google Maps instead of Nominatim. To do this:

Change the import from:

```python
from geopy.geocoders import Nominatim
```

to:

```python
from geopy.geocoders import GoogleV3
```

---

In **getCoordinates()** from:

```python
geolocator = Nominatim(user_agent = "IndieMap by PaaaulZ")
```

to:

```python
geolocator = GoogleV3(api_key=YOUR_GOOGLE_API_KEY_HERE)
```
